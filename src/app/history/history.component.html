<div class="history-container">
  <!-- 選擇器區塊 -->
  <div class="selector-container">
    <!-- 資料類型 -->
    <div class="data-selector">
      <label for="dataSelect">資料類型：</label>
      <select id="dataSelect" [(ngModel)]="selectedDataset" (change)="updateChart()">
        <option value="RT">RT</option>
        <option value="PWH">PWH</option>
      </select>
    </div>

    <!-- 時間區段 -->
    <div class="time-selector">
      <label for="start">開始時間：</label>
      <input type="datetime-local" id="start" [(ngModel)]="startDate" (change)="updateChart()" />

      <label for="end">結束時間：</label>
      <input type="datetime-local" id="end" [(ngModel)]="endDate" (change)="updateChart()" />
    </div>
  </div>

  <!-- 圖表 + 分析 -->
  <div class="chart-analysis-container">
    <div class="chart-container">
      <iframe
        [src]="grafanaUrl"
        width="100%"
        height="450"
        frameborder="0"
        style="border: none; border-radius: 12px;">
      </iframe>
    </div>

    <div class="analysis-grid">
      <div class="stat-card">
        <h4><i class="fas fa-chart-bar icon"></i> 平均值</h4>
        <p>{{ analysis.avg }} kWh</p>
      </div>
      <div class="stat-card">
        <h4><i class="fas fa-chart-line icon"></i> 最大值</h4>
        <p>{{ analysis.max }} kWh</p>
      </div>
      <div class="stat-card">
        <h4><i class="fas fa-chart-area icon"></i> 最小值</h4>
        <p>{{ analysis.min }} kWh</p>
      </div>
      <div class="stat-card">
        <h4><i class="fas fa-leaf icon"></i> 節能量</h4>
        <p>{{ totalSaved }} kWh</p>
      </div>
    </div>
  </div>
</div>
